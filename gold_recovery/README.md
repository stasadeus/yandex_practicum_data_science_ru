# Восстановление золота из руды
Заказчик - компания, разрабатывающая решения для эффективной работы промышленных предприятий.

## Задача
Подготовить прототип модели машинного. Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды используя данные с параметрами добычи и очистки.
Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.
Нужно спрогнозировать сразу две величины:  
- эффективность обогащения чернового концентрата;  
- эффективность обогащения финального концентрата.

**Технологический процесс**
Когда добытая руда проходит первичную обработку, получается дроблёная смесь. Её отправляют на флотацию (обогащение) и двухэтапную очистку:

Флотация  
1. Во флотационную установку подаётся смесь золотосодержащей руды. После обогащения получается черновой концентрат и «отвальные хвосты», то есть остатки продукта с низкой концентрацией ценных металлов.
На стабильность этого процесса влияет непостоянное и неоптимальное физико-химическое состояние флотационной пульпы (смеси твёрдых частиц и жидкости).  
2. Очистка  
Черновой концентрат проходит две очистки. На выходе получается финальный концентрат и новые отвальные хвосты.  

## Данные

**Описание данных**

*Технологический процесс:*    
- Rougher feed — исходное сырье  
- Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant  
    - Xanthate — ксантогенат (промотер, или активатор флотации);   
    - Sulphate — сульфат (на данном производстве сульфид натрия);  
    - Depressant — депрессант (силикат натрия).  
- Rougher process (англ. «грубый процесс») — флотация  
- Rougher tails — отвальные хвосты  
- Float banks — флотационная установка  
- Cleaner process — очистка  
- Rougher Au — черновой концентрат золота  
- Final Au — финальный концентрат золота  

*Параметры этапов:*  
- air amount — объём воздуха  
- fluid levels — уровень жидкости  
- feed size — размер гранул сырья  
- feed rate — скорость подачи  

*Наименование признаков:*  

Наименование признаков должно быть такое:  
`[этап].[тип_параметра].[название_параметра]`  
Пример: `rougher.input.feed_ag`  

Возможные значения для блока `[этап]`:  
- rougher — флотация    
- primary_cleaner — первичная очистка  
- secondary_cleaner — вторичная очистка  
- final — финальные характеристики  
Возможные значения для блока `[тип_параметра]`:  
- input — параметры сырья  
- output — параметры продукта  
- state — параметры, характеризующие текущее состояние этапа  
- calculation — расчётные характеристики  

**Расчёт эффективности**  

Необходимо смоделировать процесс восстановления золота из золотосодержащей руды.
Эффективность обогащения рассчитывается по формуле  

$$ Recovery = \frac{C\times{}(F - T)}{F\times{}(C - T)}\times{} 100\% $$

где:  
- C — доля золота в концентрате после флотации/очистки;  
- F — доля золота в сырье/концентрате до флотации/очистки;  
- T — доля золота в отвальных хвостах после флотации/очистки.

Для прогноза коэффициента нужно найти долю золота в концентратах и хвостах. Причём важен не только финальный продукт, но и черновой концентрат.  

**Метрика качества**

Для решения задачи вводится новая метрика качества — sMAPE (англ. Symmetric Mean Absolute Percentage Error, «симметричное среднее абсолютное процентное отклонение»).

$$ sMAPE = \frac{1}{N} \displaystyle\sum_{i=1}^{N} \frac{|y_i - \hat{y_i}|}{(|y_i| + |\hat{y_i}|)/2} \times{} 100\% $$  

где:  
- $y_i$ - значение целевого признака для объекта с порядковым номером i в выборке, на которой измеряется качество;  
- $\hat{y_i}$ - значение предсказания для объекта с порядковым номером i, например, в тестовой выборке;  
- N - количество объектов в выборке;  

Нужно спрогнозировать сразу две величины:
- эффективность обогащения чернового концентрата rougher.output.recovery;
- эффективность обогащения финального концентрата final.output.recovery.

Итоговая метрика складывается из двух величин:

$$ Итоговое sMAPE = 25\%\times{} sMAPE(rougher) + 75\% \times{} sMAPE(final) $$
$$ 35 35 35 35$$

## Используемые библиотеки
numpy, pandas, missingno, matplotlib, seaborn, sklearn
